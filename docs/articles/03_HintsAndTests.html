<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3 Hints and Tests • RTutor</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="3 Hints and Tests">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RTutor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2020.6.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_RTutorOverview.html">1 RTutor Overview</a>
    </li>
    <li>
      <a href="../articles/02_ElementsSolutionFile.html">2 Elements of a Solution File</a>
    </li>
    <li>
      <a href="../articles/03_HintsAndTests.html">3 Hints and Tests</a>
    </li>
    <li>
      <a href="../articles/04_Evaluation.html">4 Evaluation Order and Environments</a>
    </li>
    <li>
      <a href="../articles/05_Deploy%20Problem%20Sets%20as%20Package%20on%20Github.html">5 Deploy RTutor Problem Set as a Package on Github</a>
    </li>
    <li>
      <a href="../articles/06_Deploy%20problem%20set%20on%20shinyapps.io.html">6 Deploy a problem set on shinyapps.io</a>
    </li>
    <li>
      <a href="../articles/FAQ_and_Sneaky_Errors.html">Sneaky Errors</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/skranz/RTutor">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>3 Hints and Tests</h1>
            
      
      
      <div class="hidden name"><code>03_HintsAndTests.Rmd</code></div>

    </div>

    
    
<div id="hints-and-tests" class="section level1">
<h1 class="hasAnchor">
<a href="#hints-and-tests" class="anchor"></a>Hints and Tests</h1>
<div id="automatic-hints" class="section level2">
<h2 class="hasAnchor">
<a href="#automatic-hints" class="anchor"></a>Automatic Hints</h2>
<p>I put a lot of effort into writing sensible automatic tests and hints for RTutor. In most cases problem set tasks without customized hints or tests should yield a decent experience for users.</p>
<p>If no custom hint is provided, RTutor calls automatically either <code>hint.for.assign</code> (if a variable is assigned), <code>hint.for.call</code> (function call without assignment), <code>hint.for.function</code> (if the user generates a function) or <code>hint.for.compute</code> (for multi-step computations in a compute block).</p>
<p>For an example of an automatic hint, consider a chunk were students shall write a dplyr pipe. The code in the solution file is:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#&lt; task</span></a>
<a class="sourceLine" id="cb1-2" title="2">dat = tibble(a = sample(<span class="kw">1:</span><span class="dv">4</span>,<span class="dv">100</span>, replace=TRUE), x=runif(<span class="dv">100</span>,<span class="dv">0</span>,a))</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb1-4" title="4">dat %&gt;%</a>
<a class="sourceLine" id="cb1-5" title="5">  group_by(a) %&gt;%</a>
<a class="sourceLine" id="cb1-6" title="6">  summarize(mean_x = mean(x)) %&gt;%</a>
<a class="sourceLine" id="cb1-7" title="7">  arrange(-mean_x)</a></code></pre></div>
<p>If the user writes the following wrong code</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb2-1" title="1">dat = tibble(a = sample(<span class="kw">1:</span><span class="dv">4</span>,<span class="dv">100</span>, replace=TRUE), x=runif(<span class="dv">100</span>,<span class="dv">0</span>,a))</a>
<a class="sourceLine" id="cb2-2" title="2">dat %&gt;%</a>
<a class="sourceLine" id="cb2-3" title="3">  group_by(a) %&gt;%</a>
<a class="sourceLine" id="cb2-4" title="4">  summarize(mean_x = sum(x)) %&gt;%</a>
<a class="sourceLine" id="cb2-5" title="5">  arrange(-mean_x)</a></code></pre></div>
<p>The test fails with a not very informative message:</p>
<pre><code>Error: 
You have not yet entered all correct commands in chunk 1.
For a hint, type hint() in the console and press Enter.</code></pre>
<p>When typing <code><a href="../reference/hint.html">hint()</a></code> the automatic hint shows a relatively detailed error analysis:</p>
<pre><code>In your following pipe chain, I detect an error in the 3rd element:

dat %&gt;%
   group_by(a) %&gt;%
   summarize(mean_x = sum(x)) %&gt;% !! WRONG !!
   arrange(-mean_x) 

It is correct to call summarize. But: Your argument mean_x = sum(x)
differs from my solution, where I call the function mean.</code></pre>
<p>There are cases were you may want to customize your hints. Sometimes the automatic hints may reveal to much, sometimes they may reveal to little, or sometimes you just want to really polish your problem set and want hints with nicer texts.</p>
<p>There are also (in my experience substantially fewer) cases, in which you want to adapt the automatic correctness tests. We will describe test customization further below.</p>
</div>
<div id="analyse-students-submissions-to-improve-hints" class="section level2">
<h2 class="hasAnchor">
<a href="#analyse-students-submissions-to-improve-hints" class="anchor"></a>Analyse students’ submissions to improve hints</h2>
<p>In general it is hard to predict where and how hints should be customized. If you use your problem sets in a course in which students submit there solution, take a look at the README.md of the companion package <a href="https://github.com/skranz/RTutorSAGI">RTutorSAGI</a>. It describes how you can analyse log files contained in the submission to detect and improve problematic tasks were many students got stuck. This allows for a nice iterative improvement process for your problem sets.</p>
</div>
</div>
<div id="customizing-hints" class="section level1">
<h1 class="hasAnchor">
<a href="#customizing-hints" class="anchor"></a>Customizing Hints</h1>
<div id="custom-hints" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-hints" class="anchor"></a>Custom hints</h2>
<p>Consider the following specification in a problem set solution file. The user shall store the mean of a variable <code>x</code> in the variable <code>m</code> and then show <code>m</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb5-1" title="1">m = mean(x)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&lt; hint</span></a>
<a class="sourceLine" id="cb5-3" title="3">cat(<span class="st">"Use Google, e.g. search for 'R compute mean'."</span>)</a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb5-5" title="5">m</a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&lt; hint</span></a>
<a class="sourceLine" id="cb5-7" title="7">cat(<span class="st">"Great, you computed m. But read the task exactly, you shall also show it. Just type m in your code."</span>)</a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt;</span></a></code></pre></div>
<p>The <code>#&lt; hint</code> blocks describe the code that is run if the user calls <code><a href="../reference/hint.html">hint()</a></code> after the expression directly above was not solved correctly.</p>
<p>We have a different hint for each of the two expressions. Such a custom hint block overwrites the automatic hints, which won’t be shown. A motivation to overwrite the first automatic hint is that it makes the solution too simple by already revealing the function name <code>mean</code> (although not the argument <code>y</code>). Here the custom hint pushes students to learn the extremely useful method to solve problems when coding: search the internet.</p>
<p>The second custom hint is not really neccessary though, since the automatic hint essentially reveals the same info. We can also set custom hints only for some expressions in a chunk, e.g.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb6-1" title="1">m = mean(x)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&lt; hint</span></a>
<a class="sourceLine" id="cb6-3" title="3">cat(<span class="st">"Use Google, e.g. search for 'R compute mean'."</span>)</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb6-5" title="5">m</a></code></pre></div>
</div>
<div id="adaptive-custom-hints" class="section level2">
<h2 class="hasAnchor">
<a href="#adaptive-custom-hints" class="anchor"></a>Adaptive Custom Hints</h2>
<p>The hints described above always show the same message, independent of the student’s code. Automatic hints already adapt to the student’s input and from RTutor version 2019.07.23 it is also more simple to make custom hints adaptive.</p>
<p>Here is an example, where the task is to assign the first 100 square numbers to the variable <code>z</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb7-1" title="1">z = <span class="kw">1:</span><span class="dv">100</span> * <span class="kw">1:</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&lt; hint</span></a>
<a class="sourceLine" id="cb7-3" title="3">if (true(identical(z,<span class="kw">1:</span><span class="dv">10</span>*<span class="kw">1:</span><span class="dv">10</span>))) {</a>
<a class="sourceLine" id="cb7-4" title="4">  cat(<span class="st">"Huh, you made a common mistake. Read the task precisely.</span></a>
<a class="sourceLine" id="cb7-5" title="5">  You shall assign to z the first <span class="dv">100</span> square numbers,</a>
<a class="sourceLine" id="cb7-6" title="6">not only all square numbers that are less or equal to <span class="dv">100</span><span class="st">")</span></a>
<a class="sourceLine" id="cb7-7" title="7">} else if (true(length(z)!=<span class="dv">100</span>)) {</a>
<a class="sourceLine" id="cb7-8" title="8">  cat(<span class="st">"Your variable z must have 100 elements,</span></a>
<a class="sourceLine" id="cb7-9" title="9">  but in your solution z has<span class="st">", length(z),"</span>elements.<span class="st">")  </span></a>
<a class="sourceLine" id="cb7-10" title="10">} else {</a>
<a class="sourceLine" id="cb7-11" title="11">  cat(<span class="st">"There is a simple one-line formula to compute the first 100 square numbers.</span></a>
<a class="sourceLine" id="cb7-12" title="12">  Just combine what you have learned in exercise <span class="dv">2</span> f) and in exercise <span class="dv">3</span> b).</a>
<a class="sourceLine" id="cb7-13" title="13"><span class="st">")</span></a>
<a class="sourceLine" id="cb7-14" title="14">}</a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt;</span></a></code></pre></div>
<p>The code in the hint block will be evaluated in an environment in which all variables defined in earlier solved chunks are known. Also (at least if you use the default tests) the student’s current code has been already be evaluated in the hint environment.</p>
<p>This means whether whether <code>z</code> exists in the hint environment depends on whether the user has defined it in her solution for the chunk or not. The function <code>true</code> is a robust version of <code>isTRUE</code> that never throws an error. This means even if <code>z</code> does not exist and thus the expression cannot be evaluated, we just get a <code>FALSE</code>.</p>
</div>
<div id="add_to_hint-blocks-to-combine-automatic-and-custom-hints" class="section level2">
<h2 class="hasAnchor">
<a href="#add_to_hint-blocks-to-combine-automatic-and-custom-hints" class="anchor"></a>add_to_hint blocks to combine automatic and custom hints</h2>
<p>There are many situations were you want to keep the automatic hint but just add some additional hint. Then write your hint code in an <code>add_to_hint</code>block.</p>
<p>Here is an example for an adaptive custom hint in an <code>#&lt; add_to_hint</code> block from one of my problem sets:</p>
<blockquote>
<p>Task: Using the command <code>cbind</code>, generate the matrix X of explanatory variable whose first column consists of 1 and the second column consists of p.</p>
</blockquote>
<div class="sourceCode" id="cb8"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb8-1" title="1">X = cbind(<span class="dv">1</span>,p)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&lt; add_to_hint</span></a>
<a class="sourceLine" id="cb8-3" title="3">if (exists(<span class="st">"x"</span>) &amp; !exists(<span class="st">"X"</span>)) {</a>
<a class="sourceLine" id="cb8-4" title="4">  cat(<span class="st">"It looks like you assigned the value to 'x' (lowercase), but you shall assign the value to 'X' (uppercase)."</span>)</a>
<a class="sourceLine" id="cb8-5" title="5">}</a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt;</span></a></code></pre></div>
<p>Looking at the logs of students’ solution, it became apparent that many mixed up X with x. The automatic hint did not help for this problem, yet in other cases, it was helpful. So I just wanted to add this specific custom hint to the automatic hint.</p>
</div>
<div id="hints-at-the-beginning-of-chunk" class="section level2">
<h2 class="hasAnchor">
<a href="#hints-at-the-beginning-of-chunk" class="anchor"></a>Hints at the beginning of chunk</h2>
<p>If you place a hint at the beginning of a chunk, the hint text will be added to all the hints of the individual commands.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb9-1" title="1"><span class="co">#&lt; hint</span></a>
<a class="sourceLine" id="cb9-2" title="2">cat(<span class="st">"This hint will be added to the automatic hints</span></a>
<a class="sourceLine" id="cb9-3" title="3">of all commands below.<span class="st">")</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb9-5" title="5">x = <span class="kw">1:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb9-6" title="6">y = x^<span class="dv">2</span></a></code></pre></div>
</div>
</div>
<div id="customizing-tests" class="section level1">
<h1 class="hasAnchor">
<a href="#customizing-tests" class="anchor"></a>Customizing Tests</h1>
<p>I tried my best to automatically test whether the student entered a correct solution or not.</p>
<p>A typical reason for adapting the automatic tests or writing custom tests is when you want to allow several correct solutions for a specific task.</p>
<div id="specifying-parameters-of-automatic-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#specifying-parameters-of-automatic-tests" class="anchor"></a>Specifying parameters of automatic tests</h2>
<p>Automatic tests either call <code>check.assign</code> (if a value is assigned to a variable), <code>check.call</code> (a statement that does not assign a variable), or <code>check.function</code> (if a function is generated). These test function have a number of arguments, that allow to customize the tests.</p>
<p>A <code>test_arg</code> blocks allows you to change the arguments of a default test for the preceding statement. Consider the following example:</p>
<pre><code>plot(x=p,y=q,main="A plot", xlab="Prices")
#&lt; test_arg
  ignore.arg = c("main","xlab")
  allow.extra.arg=TRUE
#&gt;</code></pre>
<p>The <code>#&lt; test_arg</code> block customizes the parameters <code>ignore.arg</code> and <code>allow.extra.arg</code> of the <code>check.call</code> function. The parameter <code>ignore.arg = c("main","xlab")</code> means that the student does not have to add these two arguments to the plot function or can use different values. The parameter <code>allow.extra.arg=TRUE</code> allows the student to specify additional arguments when calling plot, e.g. specifying a <code>ylab</code>. So essentially, it will now only be tested whether the x and y arguments of the plot are correct and any customization of the plot will still be considered a correct solution. See the help of <code>check.call</code> for a description of arguments.</p>
</div>
<div id="allowing-several-correct-solutions" class="section level2">
<h2 class="hasAnchor">
<a href="#allowing-several-correct-solutions" class="anchor"></a>Allowing several correct solutions</h2>
<p>Consider the following example</p>
<blockquote>
<p>Task: Let x contain the square roots of 4</p>
</blockquote>
<div class="sourceCode" id="cb11"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb11-1" title="1">x = c(-<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">#&lt; test_arg</span></a>
<a class="sourceLine" id="cb11-3" title="3">other.sols = list(quote(</a>
<a class="sourceLine" id="cb11-4" title="4">  x&lt;-c(<span class="dv">2</span>,-<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-5" title="5">))</a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&lt; add_to_hint</span></a>
<a class="sourceLine" id="cb11-8" title="8">if (true(identical(x,<span class="dv">2</span>) | identical(x,-<span class="dv">2</span>))) {</a>
<a class="sourceLine" id="cb11-9" title="9">  cat(<span class="st">"Recall that 4 has two square roots: a positive and a negative one.)</span></a>
<a class="sourceLine" id="cb11-10" title="10">}</a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#&gt;</span></a></code></pre></div>
<p>The argument <code>other.sols</code> of the default test function <code>check.assign</code> takes a list of quoted assignments that consitute alternative correct solutions. In the example above, we don’t care about the order of the solution vector. Note that you must assign with <code>&lt;-</code> instead of <code>=</code> inside the <code>quote</code> function.</p>
</div>
<div id="testing-only-selected-columns-in-a-data-frame" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-only-selected-columns-in-a-data-frame" class="anchor"></a>Testing only selected columns in a data frame</h2>
<p>Consider a data set <code>dat</code> were we observe the sales quantity <code>q</code> of all car models for different years and regions. The student has the task to create a new data frame <code>dat1</code> with an additional column that contains the market <code>share</code> of each car model in each year and region. We don’t care with which exact commands <code>share</code> is computed, however.</p>
<p>Below is the specification in the solution file:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">dat1 =<span class="st"> </span>dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(year,region) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb12-4" title="4">    <span class="dt">Q =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(q), <span class="co"># Total sales</span></a>
<a class="sourceLine" id="cb12-5" title="5">    <span class="dt">share =</span> q <span class="op">/</span><span class="st"> </span>Q   <span class="co"># Market share of each car</span></a>
<a class="sourceLine" id="cb12-6" title="6">  )</a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">#&lt; test_arg</span></a>
<a class="sourceLine" id="cb12-8" title="8">check.cols =<span class="st"> "share"</span></a>
<a class="sourceLine" id="cb12-9" title="9">sort.cols =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"year"</span>,<span class="st">"market"</span>,<span class="st">"car_model"</span>)</a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co">#&gt;</span></a></code></pre></div>
<p>In the sample solution, we compute an intermediate variable <code>Q</code>, which is not really neccessary to solve the exercise. The test argument <code>check.cols</code> can specify a subset of columns that will be checked. Here we only want to check the column <code>share</code>. The argument <code>sort.cols</code> specifies that both the sample solution and the student’s solution shall be sorted by the given columns. If the sort columns uniquely identify each row, this guarantees that solution is also accepted if the student has ordered the data frame in a different way than the sample solution. (If the student deletes one of the sort columns, the test will return <code>FALSE</code>.)</p>
<p>While the correctness checks accept many different solutions, the automatic hints when <code><a href="../reference/hint.html">hint()</a></code> is typed will guide the student along the concrete given sample solution.</p>
<p>Note that <code>check.cols</code> and <code>sort.cols</code> are only used if the sample solution computes a <code>data.frame</code> or <code>tibble</code>.</p>
</div>
<div id="custom-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-tests" class="anchor"></a>Custom tests</h2>
<p>If you need more customization, e.g. because there is a large number of correct solutions, you can use a <code>test</code> block. Unlike a <code>hint</code> block you cannot just enter arbitrary code that will be evaluated in an approbriate environment. Instead you should call one or several given test functions like <code>holds.true</code>, <code>check.variable</code>, <code>check.expr</code>, <code>test.H0.rejected</code>, <code>test.H0</code> and <code>check.regression</code>.</p>
<p>Consider the following an example:</p>
<pre><code>#' b) Save in the variable u a vector of 4 different numbers
u = c(3,6,7,99)  
#&lt; test
check.variable("u",c(3,6,7,99),values=FALSE)
#&gt;</code></pre>
<p>The automatic test <code>check.assign</code> would pass if one of the following two conditions is met:</p>
<ul>
<li>
<code>u</code> has the same value than in the solution. This means <code>u=c(2,5,6,98)+1</code> would also pass as correct solution</li>
<li>
<code>u</code> is generated by an equivalent call as in the solution (equivalent means the function name should be the same and the arguments should have the same value). This is useful if the solution is a call that generates a random variable like <code>x = runif(1)</code>.</li>
</ul>
<p>Yet in this example, the automatic test is too restrictive. The student shall just generate some arbitrary vector consisting of 4 numbers. The block</p>
<pre><code>#&lt; test
check.variable("u",c(3,6,7,99),values=FALSE)
#&gt;</code></pre>
<p>replaces the automatic test with a test that just checks whether a variable <code>u</code> exists, and has the same length and class (numeric or integer) as an example solution <code><a href="https://www.rdocumentation.org/packages/base/topics/c">c(3,6,7,99)</a></code>.</p>
</div>
<div id="an-more-complex-example-of-custom-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#an-more-complex-example-of-custom-tests" class="anchor"></a>An more complex example of custom tests</h2>
<p>Here is a more complex example for customized tests and hints.</p>
<blockquote>
<p>Task: Simulate a vector p of T prices that are correlated (but not perfectly correlated) with the weather w but uncorrelated with the demand shock u.</p>
</blockquote>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">p =<span class="st"> </span><span class="fl">1.1</span><span class="op">*</span>c <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>w</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co">#&lt; test</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw"><a href="../reference/check.variable.html">check.variable</a></span>(<span class="st">"p"</span>,<span class="fl">1.1</span><span class="op">*</span>c <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>w,<span class="dt">values=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb15-4" title="4"><span class="kw"><a href="../reference/test.H0.rejected.html">test.H0.rejected</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor.test">cor.test</a></span>(p,w),<span class="dt">failure.message=</span><span class="st">"I don't find a significant correlation between p and w (p-value=={{p_value}})"</span>)</a>
<a class="sourceLine" id="cb15-5" title="5"><span class="kw"><a href="../reference/holds.true.html">holds.true</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(p,w)<span class="op">&lt;</span><span class="dv">1</span><span class="fl">-1e-14</span>, <span class="dt">failure.message=</span><span class="st">"p and w shall not be perfectly correlated!"</span>)</a>
<a class="sourceLine" id="cb15-6" title="6"><span class="kw"><a href="../reference/test.H0.html">test.H0</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor.test">cor.test</a></span>(p,u),<span class="dt">failure.message=</span><span class="st">"I do find a significant correlation between p and u (p-value=={{p_value}}), but they shall be uncorrelated."</span>)</a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">#&lt; hint</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="kw"><a href="../reference/display.html">display</a></span>(<span class="st">"To make your prices correlated with w, you have to make w appear in the formula of p. To make p not perfectly correlated with p, there must also be other random factors that influence p, like cost c or some newly drawn vector of random price shocks."</span>)</a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">#&gt;</span></a></code></pre></div>
<p>We still provide a sample solution <code>p = 1.1*c + 0.5*w</code>, but many other solutions are possible here.</p>
<p>A feasible solution must pass all 4 tests in the test block to be accepted. The function <code>holds.true</code> is a quite general tool that can be used in custom tests.</p>
<p>The functions <code>test.H0.rejected</code>, and <code>test.H0</code> are just examples for special purpose convenience test functions.</p>
<p>Note that if you specify a custom test there will be no automatic hint. We thus added a custom hint.</p>
</div>
<div id="testing-a-function-written-by-the-student" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-a-function-written-by-the-student" class="anchor"></a>Testing a function written by the student</h2>
<p>Personally, I find it very valuable if students learn to write own functions. However, it is not easy to nicely test functions and students with little programming experience can get stuck easily.</p>
<p>Assume, you would like students to write an OLS function</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb16-1" title="1">ols = function(y,X) {</a>
<a class="sourceLine" id="cb16-2" title="2">  Xt = t(X)</a>
<a class="sourceLine" id="cb16-3" title="3">  invXtX = solve(Xt %*% X)</a>
<a class="sourceLine" id="cb16-4" title="4">  beta.hat = invXtX %*% Xt %*% y</a>
<a class="sourceLine" id="cb16-5" title="5">  as.numeric(beta.hat)</a>
<a class="sourceLine" id="cb16-6" title="6">}</a></code></pre></div>
<p>Directly asking them to correctly write such a function will probably fail for many students.</p>
<p>But you could first create one or several chunks, were students first develop the function body for an example. A solved chunk may look like</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># Example arguments</span></a>
<a class="sourceLine" id="cb17-2" title="2">x1 = <span class="kw">1:</span>T </a>
<a class="sourceLine" id="cb17-3" title="3">y = <span class="dv">100</span> + <span class="dv">2</span>*x1 + rnorm(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-4" title="4">X = cbind(<span class="dv">1</span>,x1)</a>
<a class="sourceLine" id="cb17-5" title="5"></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co"># Code that we will put inside the function</span></a>
<a class="sourceLine" id="cb17-7" title="7">Xt = t(X)</a>
<a class="sourceLine" id="cb17-8" title="8">invXtX = solve(Xt %*% X)</a>
<a class="sourceLine" id="cb17-9" title="9">beta.hat = invXtX %*% Xt %*% y</a>
<a class="sourceLine" id="cb17-10" title="10">as.numeric(beta.hat)</a></code></pre></div>
<p>Then provide a function stub like</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb18-1" title="1">ols = function(y,X) {</a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="co"># Insert your code here</span></a>
<a class="sourceLine" id="cb18-3" title="3">}</a></code></pre></div>
<p>and let students insert their code here.</p>
<p>Here is an example how you might specify the second chunk in your solution file:</p>
<pre><code>#&lt; fill_in
ols = function(y,X) {
  
  # enter code to compute beta.hat here ...
  
  return(as.numeric(beta.hat))
}
#&gt;
ols &lt;- function(y,X) {
  beta.hat = solve(t(X) %*% X) %*% t(X) %*% y
  as.numeric(beta.hat)
}
#&lt; test_arg
  ols(
    c(100,50,20,60),
    cbind(1,c(20,30,15,20))
  )
#&gt;
#&lt; add_to_hint
display("Just insert inside the function ols the code to compute beta.hat from the previous task")
#&gt;</code></pre>
<p>First, we have a <code>#&lt; fill_in</code> block that specifies an unfinished function that will be shown to the student. Afterward, we have an example of a correct function <code>ols</code>. Then the <code>#&lt; test_arg</code> block specifies parameters for the automatic test <code>check.function</code>. The unnamed parameter</p>
<pre><code>ols(c(100,50,20,60),cbind(1,c(20,30,15,20)))</code></pre>
<p>Specifies a test call. <code>check.function</code> will run this test call for both the sample solution and the student’s solution. The test will only pass if the both versions of the ols function return the same value. Finally, the <code>#&lt; add_to_hint</code> add some information to the automatic hint.</p>
</div>
<div id="testing-a-function-that-generates-random-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-a-function-that-generates-random-variables" class="anchor"></a>Testing a function that generates random variables</h2>
<p>If you want to check a function that creates random variables, you can compare the results of the student’s function and the official solution using the same random seed.</p>
<p>Here is an example:</p>
<pre><code>a) Write a function `runif.square` with parameters n, min and max
that generates n random variables that are the square of variables
that are uniform distributed on the interval from min to max.

```{r}
runif.square = function(n,min,max) {
  runif(n,min,max)^2
}
#&lt; test_arg
  with.random.seed(runif.square(n=20,min=4,max=9), seed=12345)
#&gt;
```</code></pre>
<p>Our test call is now embedded in the function <code>with.random.seed</code> that calls the function with a fixed random seed. Then the automatically called <code>check.function</code> only passes if the students function and official solution return the same value when called with the same random seed.</p>
<p>If a function requires simulation of more than one random number, this testing procedure only works if the student draws the random numbers in the same order than the official solution. This means your task should specify already a lot of structure for the function and tell the student not to draw any additional random variables inside the function.</p>
</div>
</div>
<div id="compute-blocks-for-computations-with-many-steps" class="section level1">
<h1 class="hasAnchor">
<a href="#compute-blocks-for-computations-with-many-steps" class="anchor"></a>Compute blocks for computations with many steps</h1>
<p>Sometimes you want to ask students to perform computations that will usually require several intermediate steps. Two somewhat opposite ways of implementing such multistep computations in a problem set would be the following:</p>
<ol style="list-style-type: lower-roman">
<li>Only check the final result and let the student figure out the intermediate steps herself.</li>
<li>Include all intermediate steps as part of the problem set</li>
</ol>
<p>A <code>#&lt; compute ... #&gt;</code> block allows an intermediate approach. Here is an example from a problem set of mine that asks a student to compute a matrix of choice probabilities from a conditional logit model.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb22-1" title="1">#&lt; compute P

## Take a look at the formula for the choice probabilities P.nj of the logit discrete choice model in the slides.

## Let exp.V be a matrix that contains the numerators of P.nj (use scale as sigma in your formula)
exp.V = exp(V/scale)

## Let sum.exp.V be a vector that contains for each person n the denominator in P.nj. You can use the function 'rowSums'. 
sum.exp.V = rowSums(exp.V)

## Compute P as ratio of the numerator and the denominator
P = exp.V / sum.exp.V
#&gt;<span class="co">#&lt; compute P</span></a>
<a class="sourceLine" id="cb22-2" title="2">    </a>
<a class="sourceLine" id="cb22-3" title="3">    <span class="co">## Take a look at the formula for the choice probabilities P.nj of the logit discrete choice model in the slides.</span></a>
<a class="sourceLine" id="cb22-4" title="4">    </a>
<a class="sourceLine" id="cb22-5" title="5">    <span class="co">## Let exp.V be a matrix that contains the numerators of P.nj (use scale as sigma in your formula)</span></a>
<a class="sourceLine" id="cb22-6" title="6">    exp.V = exp(V/scale)</a>
<a class="sourceLine" id="cb22-7" title="7">    </a>
<a class="sourceLine" id="cb22-8" title="8">    <span class="co">## Let sum.exp.V be a vector that contains for each person n the denominator in P.nj. You can use the function 'rowSums'. </span></a>
<a class="sourceLine" id="cb22-9" title="9">    sum.exp.V = rowSums(exp.V)</a>
<a class="sourceLine" id="cb22-10" title="10">    </a>
<a class="sourceLine" id="cb22-11" title="11">    <span class="co">## Compute P as ratio of the numerator and the denominator</span></a>
<a class="sourceLine" id="cb22-12" title="12">    P = exp.V / sum.exp.V</a>
<a class="sourceLine" id="cb22-13" title="13">    <span class="co">#&gt;</span></a></code></pre></div>
<p>The solution will pass as correct if the final values of <code>P</code> are correct. The student is not obliged to perform the particular intermediate computations like <code>exp.V</code>. Yet, if the student has not yet correctly computed <code>P</code> and types <code><a href="../reference/hint.html">hint()</a></code>, the hint function tries to steer the student step by step through the sample solution described in the block. The comments starting with <code>##</code> will be transformed into text that will be shown in the hint.</p>
</div>
<div id="testing-ggplot-commands-or-other-plot-commands" class="section level1">
<h1 class="hasAnchor">
<a href="#testing-ggplot-commands-or-other-plot-commands" class="anchor"></a>Testing ggplot commands (or other plot commands)</h1>
<p>RTutor is not good at providing sensible hints or automatic tests that allow a user build long ggplot chains from scratch.</p>
<p>Assume you want to show in a problem set the following ggplot:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb23-1" title="1">ggplot(data = counties,aes(x=area, y=population, col=state)) +</a>
<a class="sourceLine" id="cb23-2" title="2">  geom_point()+</a>
<a class="sourceLine" id="cb23-3" title="3">  xlim(c(<span class="dv">0</span>, <span class="dv">0</span>.1)) + </a>
<a class="sourceLine" id="cb23-4" title="4">  ylim(c(<span class="dv">0</span>, <span class="dv">500000</span>)) + </a>
<a class="sourceLine" id="cb23-5" title="5">  labs(title=<span class="st">"Area vs Population"</span>, </a>
<a class="sourceLine" id="cb23-6" title="6">       y=<span class="st">"Population"</span>, </a>
<a class="sourceLine" id="cb23-7" title="7">       x=<span class="st">"Area"</span>) +</a>
<a class="sourceLine" id="cb23-8" title="8">  theme_bw()</a></code></pre></div>
<p>One option would be to just provide the plotting commands in a <code>task_notest</code> block and don’t force the student to write anything.</p>
<p>An alternative would be to specify in your solution a fill in block, like:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><a class="sourceLine" id="cb24-1" title="1"><span class="co">#&lt; fill_in</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="co"># Fill in the ___</span></a>
<a class="sourceLine" id="cb24-3" title="3">ggplot(data = counties,aes(x=___, y=population, colour=___)) +</a>
<a class="sourceLine" id="cb24-4" title="4">  geom_point()+</a>
<a class="sourceLine" id="cb24-5" title="5">  xlim(c(<span class="dv">0</span>, <span class="dv">0</span>.1)) + </a>
<a class="sourceLine" id="cb24-6" title="6">  ylim(c(<span class="dv">0</span>, <span class="dv">500000</span>)) + </a>
<a class="sourceLine" id="cb24-7" title="7">  labs(title=<span class="st">"Area vs Population"</span>, </a>
<a class="sourceLine" id="cb24-8" title="8">       y=<span class="st">"Population"</span>, </a>
<a class="sourceLine" id="cb24-9" title="9">       x=<span class="st">"Area"</span>) +</a>
<a class="sourceLine" id="cb24-10" title="10">  theme_bw()</a>
<a class="sourceLine" id="cb24-11" title="11"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb24-12" title="12"><span class="co"># Sample solution</span></a>
<a class="sourceLine" id="cb24-13" title="13">ggplot(data = counties,aes(x=area, y=population, colour=state)) +</a>
<a class="sourceLine" id="cb24-14" title="14">  geom_point()+</a>
<a class="sourceLine" id="cb24-15" title="15">  xlim(c(<span class="dv">0</span>, <span class="dv">0</span>.1)) + </a>
<a class="sourceLine" id="cb24-16" title="16">  ylim(c(<span class="dv">0</span>, <span class="dv">500000</span>)) + </a>
<a class="sourceLine" id="cb24-17" title="17">  labs(title=<span class="st">"Area vs Population"</span>, </a>
<a class="sourceLine" id="cb24-18" title="18">       y=<span class="st">"Population"</span>, </a>
<a class="sourceLine" id="cb24-19" title="19">       x=<span class="st">"Area"</span>) +</a>
<a class="sourceLine" id="cb24-20" title="20">  theme_bw()</a></code></pre></div>
<p>Here the student only has to fill in the two mising aesthetics. Please use as placeholders the <code>___</code>, since RTutor’s hints have special treatment that internally replaces the <code>___</code> with a syntactically valid R variable name in order to parse and analyse students solutions.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#hints-and-tests">Hints and Tests</a><ul class="nav nav-pills nav-stacked">
<li><a href="#automatic-hints">Automatic Hints</a></li>
      <li><a href="#analyse-students-submissions-to-improve-hints">Analyse students’ submissions to improve hints</a></li>
      </ul>
</li>
      <li>
<a href="#customizing-hints">Customizing Hints</a><ul class="nav nav-pills nav-stacked">
<li><a href="#custom-hints">Custom hints</a></li>
      <li><a href="#adaptive-custom-hints">Adaptive Custom Hints</a></li>
      <li><a href="#add_to_hint-blocks-to-combine-automatic-and-custom-hints">add_to_hint blocks to combine automatic and custom hints</a></li>
      <li><a href="#hints-at-the-beginning-of-chunk">Hints at the beginning of chunk</a></li>
      </ul>
</li>
      <li>
<a href="#customizing-tests">Customizing Tests</a><ul class="nav nav-pills nav-stacked">
<li><a href="#specifying-parameters-of-automatic-tests">Specifying parameters of automatic tests</a></li>
      <li><a href="#allowing-several-correct-solutions">Allowing several correct solutions</a></li>
      <li><a href="#testing-only-selected-columns-in-a-data-frame">Testing only selected columns in a data frame</a></li>
      <li><a href="#custom-tests">Custom tests</a></li>
      <li><a href="#an-more-complex-example-of-custom-tests">An more complex example of custom tests</a></li>
      <li><a href="#testing-a-function-written-by-the-student">Testing a function written by the student</a></li>
      <li><a href="#testing-a-function-that-generates-random-variables">Testing a function that generates random variables</a></li>
      </ul>
</li>
      <li><a href="#compute-blocks-for-computations-with-many-steps">Compute blocks for computations with many steps</a></li>
      <li><a href="#testing-ggplot-commands-or-other-plot-commands">Testing ggplot commands (or other plot commands)</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sebastian Kranz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  


  <script type="text/javascript">
  var sc_project=12051162; 
  var sc_invisible=1; 
  var sc_security="60139410"; 
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js"
  async></script>
  <noscript><div class="statcounter"><a title="Web Analytics
  Made Easy - StatCounter" href="https://statcounter.com/"
  target="_blank"><img class="statcounter"
  src="https://c.statcounter.com/12051162/0/60139410/1/"
  alt="Web Analytics Made Easy -
  StatCounter"></a></div></noscript>
  
  
  </body>
</html>